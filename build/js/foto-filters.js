!function(){function e(u){var s=document.querySelector(u.handle),n=f(s),d=s.parentNode,r=f(d),i=document.querySelector(u.reset),a=d.offsetWidth-s.offsetWidth,c=parseFloat(getComputedStyle(s).left)/(a/100),m=document.querySelector(u.image);function f(e){var t=e.getBoundingClientRect();return{top:t.top+(document.documentElement.scrollTop||pageYOffset),left:t.left+(document.documentElement.scrollLeft||pageXOffset),bottom:t.bottom+(document.documentElement.scrollTop||pageYOffset),right:t.right+(document.documentElement.scrollLeft||pageXOffset)}}function l(e){a=d.offsetWidth-s.offsetWidth,c=parseFloat(getComputedStyle(s).left)/(a/100);var t=getComputedStyle(m).filter,o=.02*c,n=1;/contrast/.test(t)&&(n=t.match(/contrast\((\d+(?:\.\d+)?)\)/)[1]),m.style.filter="brightness("+o+")contrast("+n+")"}function p(e){a=d.offsetWidth-s.offsetWidth,c=parseFloat(getComputedStyle(s).left)/(a/100);var t=getComputedStyle(m).filter,o=.02*c,n=1;/brightness/.test(t)&&(n=t.match(/brightness\((\d+(?:\.\d+)?)\)/)[1]),m.style.filter="brightness("+n+")contrast("+o+")"}function g(e){a=d.offsetWidth-s.offsetWidth;var t=1.4/100*(c=parseFloat(getComputedStyle(s).left)/(a/100))+.3;m.style.transform="scale("+t+")"}s.addEventListener("mousedown",function(e){if(1==e.which){e.preventDefault(),n=f(s),r=f(d);var o=e.pageX-n.left;a=d.offsetWidth-s.offsetWidth,s.style.backgroundColor="#d22856",document.body.style.cursor="pointer",document.addEventListener("mousemove",t),document.addEventListener("mouseup",function e(){s.style.backgroundColor="";document.body.style.cursor="";document.removeEventListener("mousemove",t);document.removeEventListener("mousemove",l);document.removeEventListener("mousemove",p);document.removeEventListener("mousemove",g);document.removeEventListener("mouseup",e)}),"crop"==u.type&&document.addEventListener("mousemove",g),"fill"==u.type&&document.addEventListener("mousemove",l),"сontr"==u.type&&document.addEventListener("mousemove",p)}function t(e){e.preventDefault();var t=e.pageX-r.left-o;i.disabled&&(i.disabled=!1),t<=0&&(t=0),a<t&&(t=a),s.style.left=t+"px"}}),window.addEventListener("resize",function(e){for(var t=d.offsetWidth-s.offsetWidth,o=m.parentNode;o&&!o.classList.contains("post__image-overflow");)o=o.parentNode;var n=f(m);containerCoords=f(o);var r=n.right-n.left-(containerCoords.right-containerCoords.left);n.bottom,n.top,containerCoords.bottom,containerCoords.top;t!=a&&(s.style.left=t/100*c+"px",a=t),r<0&&document.documentElement.clientWidth<960&&(m.style.left=0)}),i.addEventListener("click",function(){m.style.cssText="",i.disabled=!0,s.style.left="",c=parseFloat(getComputedStyle(s).left)/(a/100)}),m.addEventListener("mouseover",function(){"crop"==u.type&&(c<=50||(this.style.cursor="grab"))}),m.addEventListener("dragstart",function(e){e.preventDefault()}),m.addEventListener("mousedown",function(e){if(1==e.which&&(e.preventDefault(),"crop"==u.type&&!(c<=50))){document.body.style.cursor="grabbing",m.style.cursor="grabbing";for(var n=m.parentNode;n&&!n.classList.contains("post__image-overflow");)n=n.parentNode;var r=f(m);containerCoords=f(n);var s={width:r.right-r.left-(containerCoords.right-containerCoords.left),height:r.bottom-r.top-(containerCoords.bottom-containerCoords.top)},d=e.pageX,i=e.pageY,a=parseFloat(getComputedStyle(m).left)||0,l=parseFloat(getComputedStyle(m).top)||0;document.addEventListener("mousemove",t),document.addEventListener("mouseup",function e(){document.body.style.cursor="";m.style.cursor="grab";document.removeEventListener("mousemove",t);document.removeEventListener("mouseup",e);m.addEventListener("mouseout",function(){m.style.cursor=""})})}function t(e){"grabbing"!=getComputedStyle(m).cursor&&(m.style.cursor="grabbing"),containerCoords=f(n),r=f(m);var t=a+(e.pageX-d);t>s.width/2&&0<s.width&&(t=s.width/2),t<-s.width/2&&0<s.width&&(t=-s.width/2),s.width<0&&(t=0);var o=l+(e.pageY-i);o>s.height/2&&(o=s.height/2),o<-s.height/2&&(o=-s.height/2),m.style.left=t+"px",m.style.top=o+"px"}})}new e({handle:".post__toggle--crop",image:".post__image",type:"crop",reset:".post__btn--reset"}),new e({handle:".post__toggle--fill",image:".post__image",type:"fill",reset:".post__btn--reset"}),new e({handle:".post__toggle--сontr",image:".post__image",type:"сontr",reset:".post__btn--reset"})}();